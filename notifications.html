<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Instagram-style Notifications</title>
<style>
  :root{
    --bg:#0f0f0f; --panel:#1a1a1a; --muted:#9a9a9a; --text:#f2f2f2; --accent:#ff2d55; --soft:#2a2a2a;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto}
  .nav{display:flex;justify-content:flex-end;align-items:center;padding:12px 16px;border-bottom:1px solid #222;position:sticky;top:0;background:var(--bg);z-index:5}
  /* Bell */
  .notif-btn{position:relative;display:grid;place-items:center;width:40px;height:40px;border-radius:999px;background:transparent;border:none;cursor:pointer}
  .notif-btn:hover{background:#181818}
  .notif-btn svg{width:22px;height:22px;fill:#ddd}
  .badge{position:absolute;top:4px;right:4px;min-width:18px;height:18px;padding:0 5px;border-radius:999px;background:var(--accent);color:#fff;font-size:11px;display:none;align-items:center;justify-content:center}
  .badge.show{display:flex}
  /* Dropdown */
  .dropdown{position:absolute;right:12px;top:60px;width:360px;max-height:60vh;overflow:auto;background:var(--panel);border:1px solid #262626;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);display:none}
  .dropdown.open{display:block}
  .dropdown-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid #262626}
  .dropdown-header h3{margin:0;font-size:16px}
  .mark-all{background:transparent;border:none;color:#6ea8ff;cursor:pointer;font-size:13px}
  .list{display:flex;flex-direction:column}
  .item{display:flex;gap:10px;padding:12px 14px;border-bottom:1px solid #202020;background:transparent}
  .item:hover{background:#171717}
  .avatar{width:40px;height:40px;border-radius:50%;background:#333;flex:0 0 auto;object-fit:cover}
  .content{flex:1;display:flex;flex-direction:column}
  .line{color:#eaeaea}
  .meta{color:var(--muted);font-size:12px;margin-top:2px}
  .unread-dot{width:8px;height:8px;border-radius:50%;background:var(--accent);align-self:center;margin-left:6px;flex:0 0 auto;visibility:hidden}
  .item.unread .unread-dot{visibility:visible}
  .empty{padding:24px;color:var(--muted);text-align:center}
  /* Toast */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:24px;background:#111;border:1px solid #262626;border-radius:12px;padding:10px 14px;display:none;gap:10px;align-items:center}
  .toast.show{display:flex;animation:fade 2.5s ease forwards}
  @keyframes fade{0%{opacity:0;transform:translate(-50%,10px)}10%{opacity:1;transform:translate(-50%,0)}80%{opacity:1}100%{opacity:0;transform:translate(-50%,10px)}}
  a.btn{background:#fff;color:#000;padding:10px 14px;border-radius:12px;text-decoration:none;font-weight:600}
  .wrap{max-width:900px;margin:40px auto;padding:0 16px}
</style>
</head>
<body>
  <div class="nav">
    <button class="notif-btn" id="notifBtn" aria-haspopup="true" aria-expanded="false" aria-controls="notifDropdown" title="Notifications">
      <!-- Bell icon -->
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 22a2.5 2.5 0 0 0 2.45-2h-4.9A2.5 2.5 0 0 0 12 22Zm8-6V11a8 8 0 1 0-16 0v5l-2 2v1h20v-1l-2-2Z"/></svg>
      <span class="badge" id="badge">0</span>
    </button>
    <div class="dropdown" id="notifDropdown" role="dialog" aria-label="Notifications">
      <div class="dropdown-header">
        <h3>Notifications</h3>
        <button class="mark-all" id="markAllBtn">Mark all as read</button>
      </div>
      <div class="list" id="notifList">
        <div class="empty">Youâ€™re all caught up ðŸŽ‰</div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <h1>Demo</h1>
    <p>Click the bell to open notifications. Use the buttons below to simulate new ones.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
      <a class="btn" href="#" id="simulateLike">+ Like</a>
      <a class="btn" href="#" id="simulateFollow">+ Follow</a>
      <a class="btn" href="#" id="simulateComment">+ Comment</a>
    </div>
  </div>

  <div class="toast" id="toast">
    <span id="toastMsg">New notification</span>
  </div>

<script>
  // --- Mock data & utilities ---
  const state = {
    notifications: [
      {
        id: crypto.randomUUID(),
        type: 'like',
        user: 'alex',
        avatar: 'https://i.pravatar.cc/80?img=12',
        text: 'liked your reel',
        time: Date.now() - 1000 * 60 * 8,
        unread: true
      },
      {
        id: crypto.randomUUID(),
        type: 'follow',
        user: 'maya',
        avatar: 'https://i.pravatar.cc/80?img=32',
        text: 'started following you',
        time: Date.now() - 1000 * 60 * 60,
        unread: true
      },
      {
        id: crypto.randomUUID(),
        type: 'comment',
        user: 'rahul',
        avatar: 'https://i.pravatar.cc/80?img=5',
        text: 'commented: â€œðŸ”¥ðŸ”¥â€',
        time: Date.now() - 1000 * 60 * 60 * 3,
        unread: false
      }
    ]
  };

  const el = (id)=>document.getElementById(id);
  const notifBtn = el('notifBtn');
  const dropdown = el('notifDropdown');
  const badge = el('badge');
  const list = el('notifList');
  const toast = el('toast');
  const toastMsg = el('toastMsg');

  function timeAgo(ts){
    const s = Math.floor((Date.now() - ts)/1000);
    if(s<60) return `${s}s`;
    const m = Math.floor(s/60);
    if(m<60) return `${m}m`;
    const h = Math.floor(m/60);
    if(h<24) return `${h}h`;
    const d = Math.floor(h/24);
    return `${d}d`;
  }

  function render(){
    // Badge
    const unreadCount = state.notifications.filter(n=>n.unread).length;
    if(unreadCount>0){ badge.textContent = unreadCount; badge.classList.add('show'); }
    else{ badge.classList.remove('show'); }

    // List
    list.innerHTML = '';
    if(state.notifications.length===0){
      list.innerHTML = '<div class="empty">Youâ€™re all caught up ðŸŽ‰</div>';
      return;
    }
    state.notifications
      .sort((a,b)=>b.time - a.time)
      .forEach(n=>{
        const item = document.createElement('div');
        item.className = 'item' + (n.unread ? ' unread' : '');
        item.innerHTML = `
          <img class="avatar" src="${n.avatar}" alt="${n.user} avatar" />
          <div class="content">
            <div class="line"><strong>${n.user}</strong> ${n.text}</div>
            <div class="meta">${timeAgo(n.time)} â€¢ ${n.type}</div>
          </div>
          <span class="unread-dot" aria-hidden="true"></span>
        `;
        item.addEventListener('click', ()=>{
          n.unread = false;
          render();
        });
        list.appendChild(item);
      });
  }

  function toggleDropdown(){
    const open = dropdown.classList.toggle('open');
    notifBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
  }

  function markAll(){
    state.notifications.forEach(n=>n.unread=false);
    render();
  }

  function showToast(msg){
    toastMsg.textContent = msg;
    toast.classList.remove('show');
    // force reflow to restart animation
    void toast.offsetWidth;
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'), 2500);
  }

  // Simulate receive new notifications
  function addNotification({type,user,text,avatar}){
    state.notifications.unshift({
      id: crypto.randomUUID(),
      type, user, text,
      avatar: avatar || `https://i.pravatar.cc/80?u=${user}`,
      time: Date.now(),
      unread: true
    });
    render();
    showToast(`${user} ${text}`);
    // Optional: play a sound
    // new Audio('ding.mp3').play();
  }

  // Wire up
  notifBtn.addEventListener('click', toggleDropdown);
  document.addEventListener('click', (e)=>{
    if(!dropdown.contains(e.target) && !notifBtn.contains(e.target)){
      dropdown.classList.remove('open');
      notifBtn.setAttribute('aria-expanded','false');
    }
  });
  el('markAllBtn').addEventListener('click', markAll);

  el('simulateLike').addEventListener('click', e=>{
    e.preventDefault();
    addNotification({type:'like', user:'sana', text:'liked your post'});
  });
  el('simulateFollow').addEventListener('click', e=>{
    e.preventDefault();
    addNotification({type:'follow', user:'arjun', text:'started following you'});
  });
  el('simulateComment').addEventListener('click', e=>{
    e.preventDefault();
    addNotification({type:'comment', user:'meera', text:'commented: â€œNice shot!â€'});
  });

  render();

  // --- Optional: integrate with your backend ---
  // Polling example (replace /notifications with your API)
  // setInterval(async ()=>{
  //   const res = await fetch('/notifications');
  //   const data = await res.json(); // [{id, type, user, text, avatar, time, unread}]
  //   state.notifications = data;
  //   render();
  // }, 15000);

  // Mark as read on open (example):
  // fetch('/notifications/read-all', { method:'POST' });
</script>
</body>
</html>

